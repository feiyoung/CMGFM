<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CMGFM: simulation • CMGFM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CMGFM: simulation">
<meta property="og:description" content="CMGFM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CMGFM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simu.html">CMGFM: simulation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/feiyoung/CMGFM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CMGFM: simulation</h1>
                        <h4 data-toc-skip class="author">Wei Liu</h4>
            
            <h4 data-toc-skip class="date">2024-06-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/feiyoung/CMGFM/blob/HEAD/vignettes/simu.Rmd" class="external-link"><code>vignettes/simu.Rmd</code></a></small>
      <div class="hidden name"><code>simu.Rmd</code></div>

    </div>

    
    
<p>This vignette introduces the usage of CMGFM for the analysis of
high-dimensional multimodality data with additional covariates, by
comparison with other methods.</p>
<p>The package can be loaded with the command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CMGFM</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: irlba</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; CMGFM :  Covariate-augumented generalized factor model is designed to account for cross-modal heterogeneity, capture nonlinear dependencies among the data, incorporate additional information, and provide excellent interpretability while maintaining high computational efficiency.</span></span></code></pre></div>
<div class="section level2">
<h2 id="generate-the-simulated-data">Generate the simulated data<a class="anchor" aria-label="anchor" href="#generate-the-simulated-data"></a>
</h2>
<p>First, we generate the data simulated data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pveclist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'gaussian'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>,<span class="st">'poisson'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>,</span>
<span>                 <span class="st">'binomial'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">sigmavec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">pvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pveclist</span><span class="op">)</span></span>
<span><span class="va">methodNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CMGFM"</span>, <span class="st">"GFM"</span>, <span class="st">"MRRR"</span>, <span class="st">"LFR"</span> , <span class="st">"GPCA"</span>, <span class="st">"COAP"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">datlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gendata_cmgfm.html">gendata_cmgfm</a></span><span class="op">(</span>pveclist <span class="op">=</span> <span class="va">pveclist</span>, seed <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">300</span>,d <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                           q <span class="op">=</span> <span class="va">q</span>, rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pveclist</span><span class="op">)</span><span class="op">)</span>, rho_z<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>                           sigmavec<span class="op">=</span><span class="va">sigmavec</span>, sigma_eps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">datlist</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 12</span></span>
<span><span class="co">#&gt;  $ XList    :List of 3</span></span>
<span><span class="co">#&gt;   ..$ : num [1:300, 1:200] -0.412 3.69 -1.696 -1.371 2.124 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : int [1:300, 1:200] 0 5 0 0 7 1 0 0 0 1 ...</span></span>
<span><span class="co">#&gt;   ..$ : int [1:300, 1:160] 0 0 1 0 0 1 1 1 1 0 ...</span></span>
<span><span class="co">#&gt;  $ Z        : num [1:300, 1:3] 0.315 0.113 0.263 -0.259 -0.07 ...</span></span>
<span><span class="co">#&gt;  $ types    : chr [1:3] "gaussian" "poisson" "binomial"</span></span>
<span><span class="co">#&gt;  $ Alist    :List of 1</span></span>
<span><span class="co">#&gt;   ..$ : num [1:300, 1:6] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ numvarmat: num [1:3, 1:2] 50 50 100 150 150 60</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:3] "gaussian" "poisson" "binomial"</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;  $ B0List   :List of 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:50, 1:6] 0.2622 -0.6594 -0.0584 0.0826 -0.3536 ...</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:150, 1:6] 0.0729 -0.1236 -0.1994 0.7284 0.5208 ...</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:50, 1:6] 0.322 -0.0678 0.0515 -0.1115 0.1911 ...</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:150, 1:6] 0.3414 -0.1357 -0.2816 -0.1411 0.0463 ...</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:100, 1:6] 0.0114 -0.4359 0.1958 -0.3451 0.0457 ...</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:60, 1:6] 0.7305 -0.0567 0.2556 0.1347 0.3636 ...</span></span>
<span><span class="co">#&gt;  $ mu0List  :List of 3</span></span>
<span><span class="co">#&gt;   ..$ : num [1:200] 0.195 0.295 0.23 -0.122 0.605 ...</span></span>
<span><span class="co">#&gt;   ..$ : num [1:200] -0.46 0.108 -0.177 -0.211 -0.469 ...</span></span>
<span><span class="co">#&gt;   ..$ : num [1:160] -0.159 -0.312 0.214 0.46 -0.783 ...</span></span>
<span><span class="co">#&gt;  $ beta0List:List of 3</span></span>
<span><span class="co">#&gt;   ..$ : num [1:3, 1:2] -1.253 0.367 -1.671 3.191 0.659 ...</span></span>
<span><span class="co">#&gt;   ..$ : num [1:3, 1:2] 0.683 0.827 0.244 -3.179 -1.575 ...</span></span>
<span><span class="co">#&gt;   ..$ : num [1:3, 1:2] 3.0383 1.9234 -2.2854 -0.7993 0.0781 ...</span></span>
<span><span class="co">#&gt;  $ Uplist   :List of 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:50, 1:7] 0.195 0.295 0.23 -0.122 0.605 ...</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:150, 1:7] -0.147 -0.418 0.228 -0.054 0.961 ...</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:50, 1:7] -0.46 0.108 -0.177 -0.211 -0.469 ...</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:150, 1:7] 0.1795 0.0427 0.1158 0.3639 0.1529 ...</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:100, 1:7] -0.159 -0.312 0.214 0.46 -0.783 ...</span></span>
<span><span class="co">#&gt;   .. ..$ : num [1:60, 1:7] 0.0809 -0.5117 -0.6635 -0.0317 -0.6377 ...</span></span>
<span><span class="co">#&gt;  $ U0List   :List of 3</span></span>
<span><span class="co">#&gt;   ..$ : num [1:300, 1:2] -0.626 0.184 -0.836 1.595 0.33 ...</span></span>
<span><span class="co">#&gt;   ..$ : num [1:300, 1:2] -0.626 0.184 -0.836 1.595 0.33 ...</span></span>
<span><span class="co">#&gt;   ..$ : num [1:300, 1:2] -0.626 0.184 -0.836 1.595 0.33 ...</span></span>
<span><span class="co">#&gt;  $ F0       : num [1:300, 1:6] -0.626 0.184 -0.836 1.595 0.33 ...</span></span>
<span><span class="co">#&gt;  $ sigma_eps: num 1</span></span>
<span><span class="va">XList</span> <span class="op">&lt;-</span> <span class="va">datlist</span><span class="op">$</span><span class="va">XList</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">datlist</span><span class="op">$</span><span class="va">Z</span></span>
<span><span class="va">numvarmat</span> <span class="op">&lt;-</span> <span class="va">datlist</span><span class="op">$</span><span class="va">numvarmat</span></span>
<span><span class="va">Uplist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">id</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">datlist</span><span class="op">$</span><span class="va">Uplist</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">im</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">datlist</span><span class="op">$</span><span class="va">Uplist</span><span class="op">[[</span><span class="va">id</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">Uplist</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">datlist</span><span class="op">$</span><span class="va">Uplist</span><span class="op">[[</span><span class="va">id</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">im</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">types</span> <span class="op">&lt;-</span> <span class="va">datlist</span><span class="op">$</span><span class="va">types</span></span></code></pre></div>
<p>Fit the CMGFM model using the function <code><a href="../reference/CMGFM.html">CMGFM()</a></code> in the R
package <code>CMGFM</code>. Users can use <code><a href="../reference/CMGFM.html">?CMGFM</a></code> to see the
details about this function</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">rlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CMGFM.html">CMGFM</a></span><span class="op">(</span><span class="va">XList</span>, <span class="va">Z</span>, types<span class="op">=</span><span class="va">types</span>, q<span class="op">=</span><span class="va">q</span>, numvarmat<span class="op">=</span><span class="va">numvarmat</span><span class="op">)</span></span>
<span>  <span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">time_smgfm</span> <span class="op">&lt;-</span> <span class="va">toc</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">tic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; iter = 2, ELBO= 1991125.056475, dELBO=1.000000 </span></span>
<span><span class="co">#&gt; iter = 3, ELBO= 2005063.871790, dELBO=0.007000 </span></span>
<span><span class="co">#&gt; iter = 4, ELBO= 2010542.767770, dELBO=0.002733 </span></span>
<span><span class="co">#&gt; iter = 5, ELBO= 2013223.740359, dELBO=0.001333 </span></span>
<span><span class="co">#&gt; iter = 6, ELBO= 2014945.775650, dELBO=0.000855 </span></span>
<span><span class="co">#&gt; iter = 7, ELBO= 2016228.099702, dELBO=0.000636 </span></span>
<span><span class="co">#&gt; iter = 8, ELBO= 2017258.673090, dELBO=0.000511 </span></span>
<span><span class="co">#&gt; iter = 9, ELBO= 2018123.186985, dELBO=0.000429 </span></span>
<span><span class="co">#&gt; iter = 10, ELBO= 2018867.740559, dELBO=0.000369 </span></span>
<span><span class="co">#&gt; iter = 11, ELBO= 2019520.570983, dELBO=0.000323 </span></span>
<span><span class="co">#&gt; iter = 12, ELBO= 2020100.677428, dELBO=0.000287 </span></span>
<span><span class="co">#&gt; iter = 13, ELBO= 2020621.729760, dELBO=0.000258 </span></span>
<span><span class="co">#&gt; iter = 14, ELBO= 2021094.053165, dELBO=0.000234 </span></span>
<span><span class="co">#&gt; iter = 15, ELBO= 2021525.743440, dELBO=0.000214 </span></span>
<span><span class="co">#&gt; iter = 16, ELBO= 2021923.351548, dELBO=0.000197 </span></span>
<span><span class="co">#&gt; iter = 17, ELBO= 2022292.338348, dELBO=0.000182 </span></span>
<span><span class="co">#&gt; iter = 18, ELBO= 2022637.400259, dELBO=0.000171 </span></span>
<span><span class="co">#&gt; iter = 19, ELBO= 2022962.720218, dELBO=0.000161 </span></span>
<span><span class="co">#&gt; iter = 20, ELBO= 2023272.171344, dELBO=0.000153 </span></span>
<span><span class="co">#&gt; iter = 21, ELBO= 2023569.470842, dELBO=0.000147 </span></span>
<span><span class="co">#&gt; iter = 22, ELBO= 2023858.213468, dELBO=0.000143 </span></span>
<span><span class="co">#&gt; iter = 23, ELBO= 2024141.525295, dELBO=0.000140 </span></span>
<span><span class="co">#&gt; iter = 24, ELBO= 2024420.678070, dELBO=0.000138 </span></span>
<span><span class="co">#&gt; iter = 25, ELBO= 2024692.109344, dELBO=0.000134 </span></span>
<span><span class="co">#&gt; iter = 26, ELBO= 2024946.637220, dELBO=0.000126 </span></span>
<span><span class="co">#&gt; iter = 27, ELBO= 2025178.764916, dELBO=0.000115 </span></span>
<span><span class="co">#&gt; iter = 28, ELBO= 2025392.822741, dELBO=0.000106 </span></span>
<span><span class="co">#&gt; iter = 29, ELBO= 2025594.259740, dELBO=0.000099 </span></span>
<span><span class="co">#&gt; iter = 30, ELBO= 2025785.510378, dELBO=0.000094</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.03    0.00    0.28</span></span></code></pre></div>
<p>Check the increased property of the evidence lower bound
function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">dat_iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>iter<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rlist</span><span class="op">$</span><span class="va">ELBO_seq</span><span class="op">)</span>, ELBO<span class="op">=</span><span class="va">rlist</span><span class="op">$</span><span class="va">ELBO_seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat_iter</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">iter</span>, y<span class="op">=</span><span class="va">ELBO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="simu_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We calculate the metrics to measure the estimation accuracy, where
the trace statistic is used to measure the estimation accuracy of
loading matrix and prediction accuracy of factor matrix, which is
evaluated by the function <code><a href="https://rdrr.io/pkg/GFM/man/measurefun.html" class="external-link">measurefun()</a></code> in the R package
<code>GFM</code>, and the root of mean square error is adopted to
measure the estimation error of bbeta.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/feiyoung/GFM" class="external-link">GFM</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: doSNOW</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: snow</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'parallel'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:snow':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     closeNode, clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span></span>
<span><span class="co">#&gt;     clusterExport, clusterMap, clusterSplit, makeCluster, parApply,</span></span>
<span><span class="co">#&gt;     parCapply, parLapply, parRapply, parSapply, recvData, recvOneData,</span></span>
<span><span class="co">#&gt;     sendData, splitIndices, stopCluster</span></span>
<span><span class="co">#&gt; GFM :  Generalized factor model is implemented for ultra-high dimensional data with mixed-type variables.</span></span>
<span><span class="co">#&gt; Two algorithms, variational EM and alternate maximization, are designed to implement the generalized factor model,</span></span>
<span><span class="co">#&gt; respectively. The factor matrix and loading matrix together with the number of factors can be well estimated.</span></span>
<span><span class="co">#&gt; This model can be employed in social and behavioral sciences, economy and finance, and  genomics,</span></span>
<span><span class="co">#&gt; to extract interpretable nonlinear factors. More details can be referred to</span></span>
<span><span class="co">#&gt; Wei Liu, Huazhen Lin, Shurong Zheng and Jin Liu. (2021) &lt;doi:10.1080/01621459.2021.1999818&gt;.   Check out our Package website (https://feiyoung.github.io/GFM/docs/index.html) for a more complete description of the methods and analyses</span></span>
<span><span class="va">hUplist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">rlist</span><span class="op">$</span><span class="va">Bf</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">rlist</span><span class="op">$</span><span class="va">muf</span><span class="op">[[</span><span class="va">m</span><span class="op">]</span><span class="op">]</span>, <span class="va">rlist</span><span class="op">$</span><span class="va">Bf</span><span class="op">[[</span><span class="va">m</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metricList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">CMGFM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">meanTr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hBlist</span>, <span class="va">Blist</span>,  <span class="va">type</span><span class="op">=</span><span class="st">'trace_statistic'</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co">###It is noted that the trace statistics is not symmetric, the true value must be in last</span></span>
<span>  <span class="va">trvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Blist</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/GFM/man/measurefun.html" class="external-link">measurefun</a></span><span class="op">(</span><span class="va">hBlist</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, <span class="va">Blist</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">trvec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">normvec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">CMGFM</span><span class="op">$</span><span class="va">Tr_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GFM/man/measurefun.html" class="external-link">measurefun</a></span><span class="op">(</span><span class="va">rlist</span><span class="op">$</span><span class="va">M</span>, <span class="va">datlist</span><span class="op">$</span><span class="va">F0</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">CMGFM</span><span class="op">$</span><span class="va">Tr_Upsilon</span> <span class="op">&lt;-</span> <span class="fu">meanTr</span><span class="op">(</span><span class="va">hUplist</span>, <span class="va">Uplist</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">CMGFM</span><span class="op">$</span><span class="va">Tr_U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GFM/man/measurefun.html" class="external-link">measurefun</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>,<span class="va">rlist</span><span class="op">$</span><span class="va">Xif</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">datlist</span><span class="op">$</span><span class="va">U0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">CMGFM</span><span class="op">$</span><span class="va">beta_norm</span> <span class="op">&lt;-</span> <span class="fu">normvec</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>,<span class="va">rlist</span><span class="op">$</span><span class="va">betaf</span><span class="op">)</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>,<span class="va">datlist</span><span class="op">$</span><span class="va">beta0List</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">CMGFM</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="va">rlist</span><span class="op">$</span><span class="va">time_use</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-with-other-methods">Compare with other methods<a class="anchor" aria-label="anchor" href="#compare-with-other-methods"></a>
</h2>
<p>We compare CMGFM with various prominent methods in the literature.
They are (1) High-dimensional LFM (Bai and Ng 2002) implemented in the R
package GFM; (2) PoissonPCA (Kenney et al. 2021) implemented in the R
package PoissonPCA; (3) Zero-inflated Poisson factor model (ZIPFA, Xu et
al. 2021) implemented in the R package ZIPFA; (4) Generalized factor
model (Liu et al. 2023) implemented in the R package GFM; (5) PLNPCA
(Chiquet et al. 2018) implemented in the R package PLNmodels; (6)
Generalized Linear Latent Variable Models (GLLVM, Hui et al. 2017)
implemented in the R package gllvm. (7) Poisson regression model for
each <span class="math inline">\(x_{ij}, (j = 1,··· ,p)\)</span>,
implemented in stats R package; (8) Multi-response reduced-rank Poisson
regression model (MMMR, Luo et al. 2018) implemented in rrpack R
package.</p>
<p>(1). First, we implemented the generalized factor model (LFM) and
record the metrics that measure the estimation accuracy and
computational cost.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metricList</span><span class="op">$</span><span class="va">GFM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res_gfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GFM/man/gfm.html" class="external-link">gfm</a></span><span class="op">(</span><span class="va">XList</span>, types<span class="op">=</span><span class="va">types</span>, q<span class="op">=</span><span class="va">q</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting the two-step method with varitional EM in the first step...</span></span>
<span><span class="co">#&gt; iter = 2, ELBO= 2697769.202257, dELBO=1.000000 </span></span>
<span><span class="co">#&gt; iter = 3, ELBO= 2702423.237715, dELBO=0.001725 </span></span>
<span><span class="co">#&gt; iter = 4, ELBO= 2704625.687731, dELBO=0.000815 </span></span>
<span><span class="co">#&gt; iter = 5, ELBO= 2705737.853138, dELBO=0.000411 </span></span>
<span><span class="co">#&gt; iter = 6, ELBO= 2706272.269271, dELBO=0.000198 </span></span>
<span><span class="co">#&gt; iter = 7, ELBO= 2706482.230846, dELBO=0.000078</span></span>
<span><span class="co">#&gt; Finish the two-step method</span></span>
<span><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time_gfm</span> <span class="op">&lt;-</span> <span class="va">toc</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">tic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">mat2list</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">B</span>, <span class="va">pvec</span>, <span class="va">by_row</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">Blist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">pcum</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">pvec</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pvec</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">by_row</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">Blist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">B</span><span class="op">[</span><span class="op">(</span><span class="va">pcum</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">pcum</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,<span class="op">]</span></span>
<span>    <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>      <span class="va">Blist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">B</span><span class="op">[</span>, <span class="op">(</span><span class="va">pcum</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">pcum</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">Blist</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">GFM</span><span class="op">$</span><span class="va">Tr_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GFM/man/measurefun.html" class="external-link">measurefun</a></span><span class="op">(</span><span class="va">res_gfm</span><span class="op">$</span><span class="va">hH</span>, <span class="va">datlist</span><span class="op">$</span><span class="va">F0</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">GFM</span><span class="op">$</span><span class="va">Tr_Upsilon</span> <span class="op">&lt;-</span> <span class="fu">meanTr</span><span class="op">(</span><span class="fu">mat2list</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">res_gfm</span><span class="op">$</span><span class="va">hmu</span>,<span class="va">res_gfm</span><span class="op">$</span><span class="va">hB</span><span class="op">)</span>, <span class="va">pvec</span><span class="op">)</span>, <span class="va">Uplist</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">GFM</span><span class="op">$</span><span class="va">Tr_U</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">GFM</span><span class="op">$</span><span class="va">beta_norm</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">GFM</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="va">time_gfm</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Eightly, we implemented the first version of multi-response
reduced-rank Poisson regression model (MMMR, Luo et al. 2018)
implemented in rrpack R package (MRRR-Z), that did not consider the
latent factor structure but only the covariates.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mrrr_run</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">Z</span>, <span class="va">numvarmat</span>, <span class="va">rank0</span>,<span class="va">family</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     <span class="va">familygroup</span>,  <span class="va">epsilon</span> <span class="op">=</span> <span class="fl">1e-4</span>, <span class="va">sv.tol</span> <span class="op">=</span> <span class="fl">1e-2</span>,</span>
<span>                     <span class="va">lambdaSVD</span><span class="op">=</span><span class="fl">0.1</span>, <span class="va">maxIter</span> <span class="op">=</span> <span class="fl">2000</span>, <span class="va">trace</span><span class="op">=</span><span class="cn">TRUE</span>, <span class="va">trunc</span><span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># epsilon = 1e-4; sv.tol = 1e-2; maxIter = 30; trace=TRUE,lambdaSVD=0.1</span></span>
<span>  <span class="va">Diag</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">q</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">vec</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">vec</span>, <span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">rrpack</span><span class="op">)</span></span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="va">rank0</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Z</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span>  <span class="co">## Trunction</span></span>
<span>  <span class="va">Y</span><span class="op">[</span><span class="va">Y</span><span class="op">&gt;</span><span class="va">trunc</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">trunc</span></span>
<span>  <span class="va">Y</span><span class="op">[</span><span class="va">Y</span><span class="op">&lt;</span> <span class="op">-</span><span class="va">trunc</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">trunc</span></span>
<span>  </span>
<span>  <span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">pvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">numvarmat</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">pvec</span> <span class="op">&lt;-</span> <span class="va">pvec</span><span class="op">[</span><span class="va">pvec</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">pcums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">pvec</span><span class="op">)</span></span>
<span>  <span class="va">idxlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">idxlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">pcums</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pvec</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pvec</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">idxlist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pcums</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">pcums</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> </span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">svdX0d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">init1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kappaC0 <span class="op">=</span> <span class="va">svdX0d1</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">offset</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>epsilon <span class="op">=</span> <span class="va">epsilon</span>, sv.tol <span class="op">=</span> <span class="va">sv.tol</span>, maxit <span class="op">=</span> <span class="va">maxIter</span>,</span>
<span>                 trace <span class="op">=</span> <span class="va">trace</span>, gammaC0 <span class="op">=</span> <span class="fl">1.1</span>, plot.cv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 conv.obj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">res_mrrr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rrpack/man/mrrr.html" class="external-link">mrrr</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, family <span class="op">=</span> <span class="va">family</span>, familygroup <span class="op">=</span> <span class="va">familygroup</span>,</span>
<span>                   penstr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>penaltySVD <span class="op">=</span> <span class="st">"rankCon"</span>, lambdaSVD <span class="op">=</span> <span class="va">lambdaSVD</span><span class="op">)</span>,</span>
<span>                   control <span class="op">=</span> <span class="va">control</span>, init <span class="op">=</span> <span class="va">init1</span>, maxrank <span class="op">=</span> <span class="va">rank0</span><span class="op">+</span><span class="va">d</span><span class="op">)</span> <span class="co">#</span></span>
<span>  </span>
<span>  <span class="va">hmu</span> <span class="op">&lt;-</span> <span class="va">res_mrrr</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span>  <span class="va">hbeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">res_mrrr</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">hTheta</span> <span class="op">&lt;-</span> <span class="va">res_mrrr</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">hbeta_rf</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pvec</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">hbeta_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">hbeta_rf</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">hbeta</span><span class="op">[</span><span class="va">idxlist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Matrix::rankMatrix(hTheta)</span></span>
<span>  <span class="va">svd_Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">hTheta</span>, nu<span class="op">=</span><span class="va">q</span>, nv<span class="op">=</span><span class="va">q</span><span class="op">)</span></span>
<span>  <span class="va">hH</span> <span class="op">&lt;-</span> <span class="va">svd_Theta</span><span class="op">$</span><span class="va">u</span></span>
<span>  <span class="va">hB</span> <span class="op">&lt;-</span> <span class="va">svd_Theta</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">Diag</span><span class="op">(</span><span class="va">svd_Theta</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">q</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">time_mrrr</span> <span class="op">&lt;-</span> <span class="va">toc</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">tic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hH<span class="op">=</span><span class="va">hH</span>, hB<span class="op">=</span><span class="va">hB</span>, hmu<span class="op">=</span> <span class="va">hmu</span>, beta<span class="op">=</span><span class="va">hbeta_rf</span>, time_use<span class="op">=</span><span class="va">time_mrrr</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">family_use</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">familygroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">datlist</span><span class="op">$</span><span class="va">XList</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">j</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">datlist</span><span class="op">$</span><span class="va">XList</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_mrrr</span> <span class="op">&lt;-</span> <span class="fu">mrrr_run</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">datlist</span><span class="op">$</span><span class="va">XList</span><span class="op">)</span>,  Z <span class="op">=</span> <span class="va">Z</span>, <span class="va">numvarmat</span>, rank0<span class="op">=</span><span class="va">q</span>, family<span class="op">=</span><span class="va">family_use</span>,</span>
<span>                       familygroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">familygroup</span><span class="op">)</span>, maxIter<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co">#</span></span>
<span><span class="co">#&gt; Loading required package: rrpack</span></span>
<span><span class="co">#&gt; iter =  1  obj/Cnorm_diff =  2285754  </span></span>
<span><span class="co">#&gt; iter =  2  obj/Cnorm_diff =  1895923  </span></span>
<span><span class="co">#&gt; iter =  3  obj/Cnorm_diff =  1602853  </span></span>
<span><span class="co">#&gt; iter =  4  obj/Cnorm_diff =  1327399  </span></span>
<span><span class="co">#&gt; iter =  5  obj/Cnorm_diff =  1131392  </span></span>
<span><span class="co">#&gt; iter =  6  obj/Cnorm_diff =  1013997  </span></span>
<span><span class="co">#&gt; iter =  7  obj/Cnorm_diff =  938923.5  </span></span>
<span><span class="co">#&gt; iter =  8  obj/Cnorm_diff =  880858.6  </span></span>
<span><span class="co">#&gt; iter =  9  obj/Cnorm_diff =  831925.5  </span></span>
<span><span class="co">#&gt; iter =  10  obj/Cnorm_diff =  788683.1  </span></span>
<span><span class="co">#&gt; iter =  11  obj/Cnorm_diff =  755306  </span></span>
<span><span class="co">#&gt; iter =  11  obj/Cnorm_diff =  755306  </span></span>
<span><span class="co">#&gt; iter =  12  obj/Cnorm_diff =  731040.1  </span></span>
<span><span class="co">#&gt; iter =  13  obj/Cnorm_diff =  720962.6  </span></span>
<span><span class="co">#&gt; iter =  14  obj/Cnorm_diff =  714250.6  </span></span>
<span><span class="co">#&gt; iter =  15  obj/Cnorm_diff =  708120.1  </span></span>
<span><span class="co">#&gt; iter =  16  obj/Cnorm_diff =  701718.5  </span></span>
<span><span class="co">#&gt; iter =  17  obj/Cnorm_diff =  694597.2  </span></span>
<span><span class="co">#&gt; iter =  18  obj/Cnorm_diff =  687113.1  </span></span>
<span><span class="co">#&gt; iter =  19  obj/Cnorm_diff =  678866.8  </span></span>
<span><span class="co">#&gt; iter =  20  obj/Cnorm_diff =  670110.7  </span></span>
<span><span class="co">#&gt; iter =  21  obj/Cnorm_diff =  660703.3  </span></span>
<span><span class="co">#&gt; iter =  22  obj/Cnorm_diff =  650862.2  </span></span>
<span><span class="co">#&gt; iter =  23  obj/Cnorm_diff =  640609.7  </span></span>
<span><span class="co">#&gt; iter =  23  obj/Cnorm_diff =  640609.7  </span></span>
<span><span class="co">#&gt; iter =  24  obj/Cnorm_diff =  634136.5  </span></span>
<span><span class="co">#&gt; iter =  25  obj/Cnorm_diff =  630295.3  </span></span>
<span><span class="co">#&gt; iter =  26  obj/Cnorm_diff =  628296.4  </span></span>
<span><span class="co">#&gt; iter =  27  obj/Cnorm_diff =  626027.9  </span></span>
<span><span class="co">#&gt; iter =  28  obj/Cnorm_diff =  623654.6  </span></span>
<span><span class="co">#&gt; iter =  29  obj/Cnorm_diff =  620954.6  </span></span>
<span><span class="co">#&gt; iter =  30  obj/Cnorm_diff =  618049.5  </span></span>
<span><span class="co">#&gt; iter =  31  obj/Cnorm_diff =  614697.6  </span></span>
<span><span class="co">#&gt; iter =  32  obj/Cnorm_diff =  610953.2  </span></span>
<span><span class="co">#&gt; iter =  33  obj/Cnorm_diff =  606644  </span></span>
<span><span class="co">#&gt; iter =  34  obj/Cnorm_diff =  601733.5  </span></span>
<span><span class="co">#&gt; iter =  34  obj/Cnorm_diff =  601733.5  </span></span>
<span><span class="co">#&gt; iter =  35  obj/Cnorm_diff =  596206.5  </span></span>
<span><span class="co">#&gt; iter =  36  obj/Cnorm_diff =  595329.2  </span></span>
<span><span class="co">#&gt; iter =  37  obj/Cnorm_diff =  594390.1  </span></span>
<span><span class="co">#&gt; iter =  38  obj/Cnorm_diff =  593270.4  </span></span>
<span><span class="co">#&gt; iter =  39  obj/Cnorm_diff =  591937.5  </span></span>
<span><span class="co">#&gt; iter =  40  obj/Cnorm_diff =  590355.4  </span></span>
<span><span class="co">#&gt; iter =  41  obj/Cnorm_diff =  588483.5  </span></span>
<span><span class="co">#&gt; iter =  42  obj/Cnorm_diff =  586277.2  </span></span>
<span><span class="co">#&gt; iter =  43  obj/Cnorm_diff =  583688  </span></span>
<span><span class="co">#&gt; iter =  44  obj/Cnorm_diff =  580665.3  </span></span>
<span><span class="co">#&gt; iter =  45  obj/Cnorm_diff =  577158.2  </span></span>
<span><span class="co">#&gt; iter =  46  obj/Cnorm_diff =  573119.8  </span></span>
<span><span class="co">#&gt; iter =  47  obj/Cnorm_diff =  568520.9  </span></span>
<span><span class="co">#&gt; iter =  47  obj/Cnorm_diff =  568520.9  </span></span>
<span><span class="co">#&gt; iter =  48  obj/Cnorm_diff =  563522.6  </span></span>
<span><span class="co">#&gt; iter =  49  obj/Cnorm_diff =  562940.9  </span></span>
<span><span class="co">#&gt; iter =  50  obj/Cnorm_diff =  562299.2  </span></span>
<span><span class="co">#&gt; iter =  51  obj/Cnorm_diff =  561541.1  </span></span>
<span><span class="co">#&gt; iter =  52  obj/Cnorm_diff =  560644.4  </span></span>
<span><span class="co">#&gt; iter =  53  obj/Cnorm_diff =  559586.9  </span></span>
<span><span class="co">#&gt; iter =  54  obj/Cnorm_diff =  558340.3  </span></span>
<span><span class="co">#&gt; iter =  55  obj/Cnorm_diff =  556872.3  </span></span>
<span><span class="co">#&gt; iter =  56  obj/Cnorm_diff =  555143.8  </span></span>
<span><span class="co">#&gt; iter =  57  obj/Cnorm_diff =  553109.6  </span></span>
<span><span class="co">#&gt; iter =  58  obj/Cnorm_diff =  550720.4  </span></span>
<span><span class="co">#&gt; iter =  59  obj/Cnorm_diff =  547934.6  </span></span>
<span><span class="co">#&gt; iter =  60  obj/Cnorm_diff =  544813.2  </span></span>
<span><span class="co">#&gt; iter =  60  obj/Cnorm_diff =  544813.2  </span></span>
<span><span class="co">#&gt; iter =  61  obj/Cnorm_diff =  543904.5  </span></span>
<span><span class="co">#&gt; iter =  62  obj/Cnorm_diff =  542573.5  </span></span>
<span><span class="co">#&gt; iter =  63  obj/Cnorm_diff =  541631.6  </span></span>
<span><span class="co">#&gt; iter =  64  obj/Cnorm_diff =  540700.3  </span></span>
<span><span class="co">#&gt; iter =  65  obj/Cnorm_diff =  539689  </span></span>
<span><span class="co">#&gt; iter =  66  obj/Cnorm_diff =  538625.6  </span></span>
<span><span class="co">#&gt; iter =  67  obj/Cnorm_diff =  537504.6  </span></span>
<span><span class="co">#&gt; iter =  68  obj/Cnorm_diff =  536307  </span></span>
<span><span class="co">#&gt; iter =  69  obj/Cnorm_diff =  534984.4  </span></span>
<span><span class="co">#&gt; iter =  70  obj/Cnorm_diff =  533467.5  </span></span>
<span><span class="co">#&gt; iter =  71  obj/Cnorm_diff =  531678.1  </span></span>
<span><span class="co">#&gt; iter =  72  obj/Cnorm_diff =  529609.3  </span></span>
<span><span class="co">#&gt; iter =  72  obj/Cnorm_diff =  529609.3  </span></span>
<span><span class="co">#&gt; iter =  73  obj/Cnorm_diff =  527865.5  </span></span>
<span><span class="co">#&gt; iter =  74  obj/Cnorm_diff =  527373.4  </span></span>
<span><span class="co">#&gt; iter =  75  obj/Cnorm_diff =  526906.6  </span></span>
<span><span class="co">#&gt; iter =  76  obj/Cnorm_diff =  526374.9  </span></span>
<span><span class="co">#&gt; iter =  77  obj/Cnorm_diff =  525761.6  </span></span>
<span><span class="co">#&gt; iter =  78  obj/Cnorm_diff =  525061.1  </span></span>
<span><span class="co">#&gt; iter =  79  obj/Cnorm_diff =  524258.2  </span></span>
<span><span class="co">#&gt; iter =  80  obj/Cnorm_diff =  523338.7  </span></span>
<span><span class="co">#&gt; iter =  81  obj/Cnorm_diff =  522276  </span></span>
<span><span class="co">#&gt; iter =  82  obj/Cnorm_diff =  521034.1  </span></span>
<span><span class="co">#&gt; iter =  83  obj/Cnorm_diff =  519565  </span></span>
<span><span class="co">#&gt; iter =  84  obj/Cnorm_diff =  517836.7  </span></span>
<span><span class="co">#&gt; iter =  85  obj/Cnorm_diff =  516024.2  </span></span>
<span><span class="co">#&gt; iter =  85  obj/Cnorm_diff =  516024.2  </span></span>
<span><span class="co">#&gt; iter =  85  obj/Cnorm_diff =  516024.2  </span></span>
<span><span class="co">#&gt; iter =  85  obj/Cnorm_diff =  516024.2  </span></span>
<span><span class="co">#&gt; iter =  85  obj/Cnorm_diff =  516024.2  </span></span>
<span><span class="co">#&gt; iter =  85  obj/Cnorm_diff =  516024.2  </span></span>
<span><span class="co">#&gt; iter =  85  obj/Cnorm_diff =  516024.2</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metricList</span><span class="op">$</span><span class="va">MRRR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">MRRR</span><span class="op">$</span><span class="va">Tr_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GFM/man/measurefun.html" class="external-link">measurefun</a></span><span class="op">(</span><span class="va">res_mrrr</span><span class="op">$</span><span class="va">hH</span>, <span class="va">datlist</span><span class="op">$</span><span class="va">F0</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">MRRR</span><span class="op">$</span><span class="va">Tr_Upsilon</span> <span class="op">&lt;-</span><span class="fu">meanTr</span><span class="op">(</span><span class="fu">mat2list</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">res_mrrr</span><span class="op">$</span><span class="va">hmu</span>,<span class="va">res_mrrr</span><span class="op">$</span><span class="va">hB</span><span class="op">)</span>, <span class="va">pvec</span><span class="op">)</span>, <span class="va">Uplist</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">MRRR</span><span class="op">$</span><span class="va">Tr_U</span> <span class="op">&lt;-</span><span class="cn">NA</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">MRRR</span><span class="op">$</span><span class="va">beta_norm</span> <span class="op">&lt;-</span> <span class="fu">normvec</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">res_mrrr</span><span class="op">$</span><span class="va">beta</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>,<span class="va">datlist</span><span class="op">$</span><span class="va">beta0List</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metricList</span><span class="op">$</span><span class="va">MRRR</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="va">res_mrrr</span><span class="op">$</span><span class="va">time_use</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-the-comparison-of-performance">Visualize the comparison of performance<a class="anchor" aria-label="anchor" href="#visualize-the-comparison-of-performance"></a>
</h2>
<p>Next, we summarized the metrics for COAP and other compared methods
in a dataframe object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list2vec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xlist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">xlist</span><span class="op">)</span></span>
<span>  <span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nn</span><span class="op">)</span></span>
<span>  <span class="va">idx_noNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">xlist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">idx_noNA</span><span class="op">)</span> <span class="va">me</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xlist</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dat_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Tr_F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">metricList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">Tr_F</span><span class="op">)</span>, </span>
<span>                         Tr_Upsilon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">metricList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">Tr_Upsilon</span><span class="op">)</span>,</span>
<span>                         Tr_U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">metricList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">Tr_U</span><span class="op">)</span>,</span>
<span>                         beta_norm <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">metricList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">beta_norm</span><span class="op">)</span>,</span>
<span>                         Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">metricList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>                         Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">metricList</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat_metric</span></span>
<span><span class="co">#&gt;            Tr_F Tr_Upsilon      Tr_U beta_norm  Time Method</span></span>
<span><span class="co">#&gt; CMGFM 0.9935940  0.7785991 0.9644858 0.8201792  0.28  CMGFM</span></span>
<span><span class="co">#&gt; GFM   0.6829262  0.7051994        NA        NA  0.62    GFM</span></span>
<span><span class="co">#&gt; MRRR  0.3629987  0.5669866        NA 1.3579832 23.30   MRRR</span></span></code></pre></div>
<p>Plot the results for COAP and other methods, which suggests that
CMGFM achieves better estimation accuracy for the quantities of
interest.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Tr_F</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">Tr_F</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Tr_Upsilon</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">Tr_Upsilon</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">beta_norm</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">beta_norm</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">Time</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span>,<span class="va">p3</span>, <span class="va">p4</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="simu_files/figure-html/unnamed-chunk-11-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="select-the-parameters">Select the parameters<a class="anchor" aria-label="anchor" href="#select-the-parameters"></a>
</h2>
<p>We applied the maximum singular value ratio based method to select
the number of factors. The results showed that the maximum SVR method
has the potential to identify the true values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">hq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MSVR.html">MSVR</a></span><span class="op">(</span><span class="va">XList</span>, <span class="va">Z</span>, types<span class="op">=</span><span class="va">types</span>, <span class="va">numvarmat</span>, q_max<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; iter = 2, ELBO= 1996035.425921, dELBO=1.000000 </span></span>
<span><span class="co">#&gt; iter = 3, ELBO= 2008870.623908, dELBO=0.006430 </span></span>
<span><span class="co">#&gt; iter = 4, ELBO= 2013435.986180, dELBO=0.002273 </span></span>
<span><span class="co">#&gt; iter = 5, ELBO= 2015986.295861, dELBO=0.001267 </span></span>
<span><span class="co">#&gt; iter = 6, ELBO= 2017732.453117, dELBO=0.000866 </span></span>
<span><span class="co">#&gt; iter = 7, ELBO= 2019070.938978, dELBO=0.000663 </span></span>
<span><span class="co">#&gt; iter = 8, ELBO= 2020159.319418, dELBO=0.000539 </span></span>
<span><span class="co">#&gt; iter = 9, ELBO= 2021075.256204, dELBO=0.000453 </span></span>
<span><span class="co">#&gt; iter = 10, ELBO= 2021863.403668, dELBO=0.000390 </span></span>
<span><span class="co">#&gt; iter = 11, ELBO= 2022552.576503, dELBO=0.000341 </span></span>
<span><span class="co">#&gt; iter = 12, ELBO= 2023162.855216, dELBO=0.000302 </span></span>
<span><span class="co">#&gt; iter = 13, ELBO= 2023708.974155, dELBO=0.000270 </span></span>
<span><span class="co">#&gt; iter = 14, ELBO= 2024202.153249, dELBO=0.000244 </span></span>
<span><span class="co">#&gt; iter = 15, ELBO= 2024651.196115, dELBO=0.000222 </span></span>
<span><span class="co">#&gt; iter = 16, ELBO= 2025063.200205, dELBO=0.000203 </span></span>
<span><span class="co">#&gt; iter = 17, ELBO= 2025444.043705, dELBO=0.000188 </span></span>
<span><span class="co">#&gt; iter = 18, ELBO= 2025798.738205, dELBO=0.000175 </span></span>
<span><span class="co">#&gt; iter = 19, ELBO= 2026131.699768, dELBO=0.000164 </span></span>
<span><span class="co">#&gt; iter = 20, ELBO= 2026446.968622, dELBO=0.000156 </span></span>
<span><span class="co">#&gt; iter = 21, ELBO= 2026748.383268, dELBO=0.000149 </span></span>
<span><span class="co">#&gt; iter = 22, ELBO= 2027039.661075, dELBO=0.000144 </span></span>
<span><span class="co">#&gt; iter = 23, ELBO= 2027324.185988, dELBO=0.000140 </span></span>
<span><span class="co">#&gt; iter = 24, ELBO= 2027603.938867, dELBO=0.000138 </span></span>
<span><span class="co">#&gt; iter = 25, ELBO= 2027876.769478, dELBO=0.000135 </span></span>
<span><span class="co">#&gt; iter = 26, ELBO= 2028134.194499, dELBO=0.000127 </span></span>
<span><span class="co">#&gt; iter = 27, ELBO= 2028368.473987, dELBO=0.000116 </span></span>
<span><span class="co">#&gt; iter = 28, ELBO= 2028582.177694, dELBO=0.000105 </span></span>
<span><span class="co">#&gt; iter = 29, ELBO= 2028781.486569, dELBO=0.000098 </span></span>
<span><span class="co">#&gt; iter = 30, ELBO= 2028969.592915, dELBO=0.000093</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>q_true<span class="op">=</span><span class="va">q</span>, q_est<span class="op">=</span><span class="va">hq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; q_true  q_est </span></span>
<span><span class="co">#&gt;      6      6</span></span></code></pre></div>
<details><summary><strong>Session Info</strong>
</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.0 (2024-04-24 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span><span class="co">#&gt; Running under: Windows 11 x64 (build 22631)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=Chinese (Simplified)_China.utf8 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=Chinese (Simplified)_China.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=Chinese (Simplified)_China.utf8</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                               </span></span>
<span><span class="co">#&gt; [5] LC_TIME=Chinese (Simplified)_China.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Asia/Shanghai</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] parallel  stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] cowplot_1.1.3    rrpack_0.1-13    GFM_1.2.1        doSNOW_1.0.20   </span></span>
<span><span class="co">#&gt;  [5] snow_0.4-4       iterators_1.0.14 foreach_1.5.2    ggplot2_3.5.1   </span></span>
<span><span class="co">#&gt;  [9] CMGFM_1.1        irlba_2.3.5.1    Matrix_1.7-0    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.9        utf8_1.2.4        generics_0.1.3    shape_1.4.6.1    </span></span>
<span><span class="co">#&gt;  [5] lattice_0.22-6    digest_0.6.35     magrittr_2.0.3    evaluate_0.23    </span></span>
<span><span class="co">#&gt;  [9] grid_4.4.0        fastmap_1.1.1     glmnet_4.1-8      jsonlite_1.8.8   </span></span>
<span><span class="co">#&gt; [13] survival_3.5-8    purrr_1.0.2       fansi_1.0.6       scales_1.3.0     </span></span>
<span><span class="co">#&gt; [17] codetools_0.2-20  textshaping_0.3.7 jquerylib_0.1.4   cli_3.6.2        </span></span>
<span><span class="co">#&gt; [21] rlang_1.1.3       splines_4.4.0     munsell_0.5.1     withr_3.0.0      </span></span>
<span><span class="co">#&gt; [25] cachem_1.0.8      yaml_2.3.8        tools_4.4.0       memoise_2.0.1    </span></span>
<span><span class="co">#&gt; [29] dplyr_1.1.4       colorspace_2.1-0  vctrs_0.6.5       R6_2.5.1         </span></span>
<span><span class="co">#&gt; [33] lifecycle_1.0.4   fs_1.6.4          htmlwidgets_1.6.4 MASS_7.3-60.2    </span></span>
<span><span class="co">#&gt; [37] ragg_1.3.1        pkgconfig_2.0.3   desc_1.4.3        pkgdown_2.0.9    </span></span>
<span><span class="co">#&gt; [41] bslib_0.7.0       pillar_1.9.0      gtable_0.3.5      glue_1.7.0       </span></span>
<span><span class="co">#&gt; [45] Rcpp_1.0.12       systemfonts_1.0.6 highr_0.10        tidyselect_1.2.1 </span></span>
<span><span class="co">#&gt; [49] xfun_0.43         tibble_3.2.1      rstudioapi_0.16.0 knitr_1.46       </span></span>
<span><span class="co">#&gt; [53] farver_2.1.1      htmltools_0.5.8.1 labeling_0.4.3    rmarkdown_2.26   </span></span>
<span><span class="co">#&gt; [57] compiler_4.4.0</span></span></code></pre></div>
</details>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Wei Liu, Jiakun Jiang, Dewei Xiang, Xuancheng Zhou.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
